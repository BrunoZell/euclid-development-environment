---
- name: Create directories on remote hosts
  hosts: nodes
  become: true
  tasks:
    - name: Create global-l0 directory
      file:
        path: /home/{{ ansible_user }}/code/global-l0
        state: directory

    - name: Create metagraph-l0 directory
      file:
        path: /home/{{ ansible_user }}/code/metagraph-l0
        state: directory

    - name: Create currency-l1 directory
      file:
        path: /home/{{ ansible_user }}/code/currency-l1
        state: directory

    - name: Create data-l1 directory
      file:
        path: /home/{{ ansible_user }}/code/data-l1
        state: directory

- name: Send JARs to remote hosts
  hosts: nodes
  become: true
  tasks:
    - name: Sending cl-keytool.jar to global-l0
      copy:
        src: ../../docker/shared/jars/cl-keytool.jar
        dest: /home/{{ ansible_user }}/code/global-l0

    - name: Sending cl-wallet.jar to global-l0
      copy:
        src: ../../docker/shared/jars/cl-wallet.jar
        dest: /home/{{ ansible_user }}/code/global-l0

    - name: Sending cl-keytool.jar to metagraph-l0
      copy:
        src: ../../docker/shared/jars/cl-keytool.jar
        dest: /home/{{ ansible_user }}/code/metagraph-l0

    - name: Sending cl-wallet.jar to metagraph-l0
      copy:
        src: ../../docker/shared/jars/cl-wallet.jar
        dest: /home/{{ ansible_user }}/code/metagraph-l0

    - name: Sending metagraph-l0.jar to metagraph-l0
      copy:
        src: ../../docker/shared/jars/cl-wallet.jar
        dest: /home/{{ ansible_user }}/code/metagraph-l0
        
    - name: Sending metagraph-l0.jar to metagraph-l0
      copy:
        src: ../../docker/shared/jars/cl-wallet.jar
        dest: /home/{{ ansible_user }}/code/metagraph-l0

    - name: Sending cl-keytool.jar to currency-l1
      copy:
        src: ../../docker/shared/jars/cl-keytool.jar
        dest: /home/{{ ansible_user }}/code/currency-l1
    
    - name: Sending cl-wallet.jar to currency-l1
      copy:
        src: ../../docker/shared/jars/cl-wallet.jar
        dest: /home/{{ ansible_user }}/code/currency-l1

    - name: Sending metagraph-l1-currency.jar to currency-l1
      copy:
        src: ../../docker/shared/jars/metagraph-l1-currency.jar
        dest: /home/{{ ansible_user }}/code/currency-l1/currency-l1.jar

    - name: Sending cl-keytool.jar to data-l1
      copy:
        src: ../../docker/shared/jars/cl-keytool.jar
        dest: /home/{{ ansible_user }}/code/data-l1

    - name: Sending cl-wallet.jar to data-l1
      copy:
        src: ../../docker/shared/jars/cl-wallet.jar
        dest: /home/{{ ansible_user }}/code/data-l1

    - name: Sending metagraph-l1-data.jar to data-l1
      copy:
        src: ../../docker/shared/jars/metagraph-l1-data.jar
        dest: /home/{{ ansible_user }}/code/data-l1/data-l1.jar

- name: Send genesis information to remote hosts
  hosts: nodes
  become: true
  tasks:
    - name: Sending metagraph l0 genesis.csv to metagraph-l0
      copy:
        src: ../../../source/metagraph-l0/genesis/genesis.csv
        dest: /home/{{ ansible_user }}/code/metagraph-l0

    - name: Sending metagraph l0 genesis.snapshot to metagraph-l0
      copy:
        src: ../../../source/metagraph-l0/genesis/genesis.snapshot
        dest: /home/{{ ansible_user }}/code/metagraph-l0

    - name: Sending metagraph l0 genesis.address to metagraph-l0
      copy:
        src: ../../../source/metagraph-l0/genesis/genesis.address
        dest: /home/{{ ansible_user }}/code/metagraph-l0

- name: Send p12 files to remote node-1
  hosts: node-1
  become: true
  tasks:
    - name: Sending p12 file to metagraph-l0
      copy:
        src: ../../../source/p12-files/{{ lookup('env', 'P12_GENESIS_FILE_NAME') }}
        dest: /home/{{ ansible_user }}/code/metagraph-l0
        
    - name: Sending p12 file to currency-l1
      copy:
        src: ../../../source/p12-files/{{ lookup('env', 'P12_GENESIS_FILE_NAME') }}
        dest: /home/{{ ansible_user }}/code/currency-l1

    - name: Sending p12 file to data-l1
      copy:
        src: ../../../source/p12-files/{{ lookup('env', 'P12_GENESIS_FILE_NAME') }}
        dest: /home/{{ ansible_user }}/code/data-l1

- name: Send p12 files to remote node-2
  hosts: node-2
  become: true
  tasks:
    - name: Sending p12 file to metagraph-l0
      copy:
        src: ../../../source/p12-files/{{ lookup('env', 'P12_NODE_2_FILE_NAME') }}
        dest: /home/{{ ansible_user }}/code/metagraph-l0
        
    - name: Sending p12 file to currency-l1
      copy:
        src: ../../../source/p12-files/{{ lookup('env', 'P12_NODE_2_FILE_NAME') }}
        dest: /home/{{ ansible_user }}/code/currency-l1

    - name: Sending p12 file to data-l1
      copy:
        src: ../../../source/p12-files/{{ lookup('env', 'P12_NODE_2_FILE_NAME') }}
        dest: /home/{{ ansible_user }}/code/data-l1

- name: Send p12 files to remote node-3
  hosts: node-3
  become: true
  tasks:
    - name: Sending p12 file to metagraph-l0
      copy:
        src: ../../../source/p12-files/{{ lookup('env', 'P12_NODE_3_FILE_NAME') }}
        dest: /home/{{ ansible_user }}/code/metagraph-l0
        
    - name: Sending p12 file to currency-l1
      copy:
        src: ../../../source/p12-files/{{ lookup('env', 'P12_NODE_3_FILE_NAME') }}
        dest: /home/{{ ansible_user }}/code/currency-l1

    - name: Sending p12 file to data-l1
      copy:
        src: ../../../source/p12-files/{{ lookup('env', 'P12_NODE_3_FILE_NAME') }}
        dest: /home/{{ ansible_user }}/code/data-l1